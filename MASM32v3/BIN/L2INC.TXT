l2inc.exe Version 1.2
~~~~~~~~~~~~~~~~~~~~~
----------------------------------------------------------------------------
Description.
----------------------------------------------------------------------------

This utility reads the "decorated" names in the PLATFORMSDK import libraries
and writes an ASM include file for each library. It has command line options
for either TASM or MASM to select either PROTO or PROCDESC syntax. It
supports [ *.lib ] for batch conversion of libraries to include files.

The suggested technique is the create a directory for the include files, run
this utility from that directory in the form,

l2inc /M drive:\path\lib\*.lib

This will write an include file for each library in the directory where the
utility is run from. The utility always writes to the current directory.
----------------------------------------------------------------------------
Using the include files
~~~~~~~~~~~~~~~~~~~~~~~
The idea behind this approach is to have a single include file for each
library so that if you need the type checking for GDI functions, you use
the syntax,

include drive:\path\gdi32.inc
include drive:\path\user32.inc
include drive:\path\kernel32.inc

includelib drive:\path\gdi32.lib
includelib drive:\path\user32.lib
includelib drive:\path\kernel32.lib

  and for each library that you need, you use the same technique of an
include file and a library file.

----------------------------------------------------------------------------
How it works
~~~~~~~~~~~~
The libraries have the names in the form,

_FunctionName@16 or _FunctionNameA@16 or _FunctionNameW@16

The decimal parameter is the length in bytes of the parameters passed to the
function, the "A" ending is for ANSI and the "W" ending is the "wide"
designation for unicode functions.

This utility filters out the "W" unicode names. The decimal parameter is
divided by 4 to give the number of DWORD size parameters passed to the
function, the leading underscore is removed and it is then expanded to the
form,

FunctionName PROTO DWORD,:DWORD,:DWORD,:DWORD

They are then sorted vertically and the duplicates are removed. Any function
with the ansi designation "A" is followed by an equate so that it conforms
to standard naming convention,

FunctionNameA PROTO DWORD,:DWORD,:DWORD,:DWORD
FunctionName equ <FunctionNameA>

This generates another duplicate problem of the form,

FunctionName PROTO DWORD,:DWORD,:DWORD,:DWORD
FunctionNameA PROTO DWORD,:DWORD,:DWORD,:DWORD
FunctionName equ <FunctionNameA>

where the third function prototype is seen as a duplicate by ML.EXE so the
first duplicate name is filtered out to ensure that each function prototype
is unique.

The include files generated by this utility are testing OK and run without
further editing.
---------------------------------------------------------------------------
User rights
~~~~~~~~~~~
Any programmer who has the need of this program is licenced by its owner
and copyright holder to have it installed on their computer to use as they
see fit. The include files generated by this program are the non-exclusive
property of the programmer who uses this program to use as they see fit.

It may be given away to any programmer who needs it and it can be included
in any freeware package for assembler programmers. Care should be taken to
ensure that the program is passed to other programmers without virus risk
or tampering. If you have any doubts, download it from one of the reputable
assembler oriented sites or from my homepage.

Two practical restrictions apply,

1. The program is not for sale and is not to be sold or included in any
   commercial package of software.

2. Any person who wishes to take any form of legal action in relation to
   this program is licenced to delete this program from their computer and
   nothing else. Failure to comply with this condition of use is a violation
   of international copyright law.

Please note that this program is not and will not be placed in the public
domain, it retains the status of being private property.

No jurisdiction is granted exemption from the conditions of licence, where
there is a conflict of interest between any jurisdiction and the programmer
who has this program installed on their computer, the programmers rights
extended under copyright have priority over any jurisdiction.

l2inc.exe Version 1.2 Copyright © S.L.Hutchesson 1999

Hope it is useful to you.

Steve Hutchesson < hutch@pbq.com.au>